---
vnet_network:   
  name: FW
  network: 10.22.0.0/16  
  region: ca-central-1
  route_tables:
    - name: Public
      routes: 
        - prefix: 0.0.0.0/0
          next_hop_type: IGW           
  subnet:
    - name: FCA-Management-AZ1
      network: 10.22.0.0/24
      rte: Public
      availability_zone: ca-central-1a
    - name: FCA-Management-AZ2
      network: 10.22.1.0/24
      rte: Public
      availability_zone: ca-central-1b  
    - name: FCA-Untrust-AZ1
      network: 10.22.10.0/24
      rte: Public
      availability_zone: ca-central-1a
    - name: FCA-Untrust-AZ2
      network: 10.22.11.0/24
      rte: Public
      availability_zone: ca-central-1b        

firewalls:
  # transit_vpc or transit_gw
  topology: transit_vpc
  mgmt_sleep: "600"
  fw_version: "8.1.0"
  #Options: 6.1.18, 7.0.17, 7.1.11, 7.1.14, 7.1.17, 7.1.18, 7.1.20, 8.0.3, 8.0.6, 8.0.8, 8.0.9, 8.0.13, 8.1.0
  fw_license_type: byol
  #Options: byol | payg1 | payg2
  fw_instances:
    - name: fca-fw01
      fw_bgp_asn: 65001
      networks:
        - subnet: FCA-Management-AZ1
          type: management
          source_dest_check: true
          eip: yes
          security_group: 
            - fw_management
            - fw_outbound_any
        - subnet: FCA-Untrust-AZ1
          type: untrust
          source_dest_check: false
          security_group: 
            - fw_untrust
            - fw_outbound_any
          eip: yes   
    - name: fca-fw02
      fw_bgp_asn: 65001
      networks:
        - subnet: FCA-Management-AZ2
          type: management
          source_dest_check: true
          security_group: 
            - fw_management
            - fw_outbound_any
          eip: yes
        - subnet: FCA-Untrust-AZ2
          type: untrust
          source_dest_check: false
          security_group: 
            - fw_untrust
            - fw_outbound_any
          eip: yes              

#Define Security Groups
security_groups:
  - name: fw_management 
    rules:
      - name: management rule1
        direction: ingress
        src_ip: 108.221.182.192/32
        src_port: 443
        dst_port: 443
        dst_network: 0.0.0.0/0
        protocol: tcp        
      - name: management rule2
        direction: ingress     
        src_ip: 108.221.182.192/32 
        src_port: 22
        dst_port: 22
        dst_network: 0.0.0.0/0
        protocol: tcp     
  - name: fw_untrust
    rules:
      - name: untrust rule1
        direction: ingress      
        src_ip: 108.221.182.192/32
        src_port: 443
        dst_port: 443
        dst_network: 0.0.0.0
        protocol: tcp  
  - name: fw_outbound_any
    rules:
      - name: Permit all outbound traffic
        direction: egress      
        src_ip: 0.0.0.0/0
        src_port: 0
        dst_port: 0
        dst_network: 0.0.0.0/0
        protocol: "-1"                   

aws_transit_gw:
  name: sy-fca-tgw
  region: ca-central-1  
  amazon_side_asn: 64922
  vpn_ecmp_support: enable
  default_route_table_association: disable
  default_route_table_propagation: disable
  auto_accept_shared_attachments: enable
  route_tables:
    - name: spoke_inbound
      associations:
        - vpc|sy-fca-spoke1-attach
        - vpc|sy-fca-spoke2-attach        
      propagations:
        - vpn|hub-fw1
        - vpn|hub-fw2
    - name: hub_inbound
      associations:
        - vpn|hub-fw1
        - vpn|hub-fw2
      propagations:
        - vpc|sy-fca-spoke1-attach  
        - vpc|sy-fca-spoke2-attach       
  vpc_attachments:
    - name: sy-fca-spoke1-attach 
      vpc: vnet|AwsTransitGwSpoke1|sy-fca-tgw-spoke1
      subnets:
        - vnet|AwsTransitGwSpoke1|FCA-Private-AZ1
        - vnet|AwsTransitGwSpoke1|FCA-Private-AZ2
    - name: sy-fca-spoke2-attach 
      vpc: vnet|AwsTransitGwSpoke2|sy-fca-tgw-spoke2
      subnets:
        - vnet|AwsTransitGwSpoke2|FCA-Private-AZ1
        - vnet|AwsTransitGwSpoke2|FCA-Private-AZ2

cloud_vpn:
  name: sy-tgw-vpn
  attachment_type: tgw
  attachment_name: sy-fca-tgw
  tunnels:
    - name: hub-fw1
      outside_ip: fca-fw01
      bgp_asn: 64800
      tunnel_1_cidr: 169.254.122.12/30
      tunnel_1_psk: blahblah
      tunnel_2_cidr: 169.254.122.16/30
      tunnel_2_psk: blahblah
    - name: hub-fw2
      outside_ip: fca-fw01
      bgp_asn: 64800
      tunnel_1_cidr: 169.254.122.20/30
      tunnel_1_psk: blahblah
      tunnel_2_cidr: 169.254.122.24/30
      tunnel_2_psk: blahblah      


global_tags:
  - name: environment
    value: dev
  - name: costcenter
    value: it